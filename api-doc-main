Education Module API Contract
TapHealth DTx - Production-Ready Healthcare Education Platform
Executive Summary
This contract defines the complete API surface for TapHealth's Education Module, designed to serve millions of requests daily across mobile and web clients in a distributed healthcare ecosystem. The API powers a personalized diabetes education platform that delivers curated video content, adaptive quizzes, and intelligent progress tracking.
Platform Capabilities:
Daily Curation Engine: AI-driven content selection with time-based delivery slots
Adaptive Assessment: Dynamic quiz system with 3/3 pass requirement and remediation paths
Progress Intelligence: Comprehensive analytics for learning outcomes and retention
Enterprise Scale: Built for high availability, horizontal scaling, and multi-tenant architecture
Production Context:
Peak Load: 100K+ concurrent users during morning/evening slots
Global Distribution: CDN-optimized video delivery across 15+ regions
Compliance: HIPAA-compliant data handling and audit trails
Integration: Seamless connectivity with TapHealth's coaching, glucose tracking, and nutrition modules
Table of Contents
Architecture Overview
Authentication & Security
API Versioning Strategy
Core Data Models
Daily Learning APIs
Assessment & Progress APIs
Content Discovery APIs
Analytics & Insights APIs
Error Handling & Resilience
Performance & Scaling
Legacy Compatibility
V2+ Enhancement APIs
Architecture Overview
Service Boundaries
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Mobile App    │    │    Web Client   │    │  Coach Portal   │
│   (iOS/Android) │    │                 │    │                 │
└─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                      │
          └──────────────────────┼──────────────────────┘
                                 │
                    ┌─────────────▼─────────────┐
                    │     API Gateway           │
                    │   (Rate Limiting,         │
                    │    Authentication)        │
                    └─────────────┬─────────────┘
                                 │
                ┌────────────────┼────────────────┐
                │                │                │
      ┌─────────▼─────────┐ ┌────▼────┐ ┌────────▼────────┐
      │  Education API    │ │ Profile │ │   Analytics     │
      │  (Content, Quiz)  │ │ Service │ │   Service       │
      └─────────┬─────────┘ └────┬────┘ └────────┬────────┘
                │                │                │
         ┌──────▼──────┐  ┌──────▼──────┐ ┌──────▼──────┐
         │   MongoDB   │  │   Redis     │ │ ClickHouse  │
         │ (Education  │  │ (Sessions)  │ │ (Analytics) │
         │  Content)   │  │             │ │             │
         └─────────────┘  └─────────────┘ └─────────────┘
Request Flow Patterns
Content Retrieval: Gateway → Education API → MongoDB (with Redis caching)
Progress Tracking: Gateway → Education API → MongoDB + Analytics Service
Real-time Updates: WebSocket connections for progress sync across devices
Background Generation: Cron jobs generate daily plans and weekly reviews automatically after user onboarding
Content Generation Strategy
Note: Per architectural decision, no manual generation endpoints are exposed. All educational content (daily plans, weekly reviews) is automatically generated by background cron jobs:
Daily Plans: Generated at 12:30 AM daily based on user progress and preferences
Weekly Reviews: Generated every 7 days per user, based on their start date, lesson completion, and quiz performance.
Client Access: Apps only retrieve pre-generated content via GET endpoints
Authentication & Security
Authentication Methods
Authorization: Bearer <JWT_TOKEN>
X-Client-Version: 2.1.0
X-Platform: ios|android|web
X-Device-ID: <unique_device_identifier>
Token Requirements:
Expiry: 3 Months for mobile, 8 hours for web
Refresh: Automatic refresh 5 minutes before expiry
Scope: education:read, education:write, analytics:read
Security Considerations
Rate Limiting: 1000 requests/hour per user, 10 requests/second burst
Data Encryption: TLS 1.3 in transit, AES-256 at rest
PII Handling: Zero PHI in education content responses
Audit Logging: All quiz submissions and progress updates logged
API Versioning Strategy
Version Support Matrix
Version
Status
Support Until
Key Features
V2 
Current 
Ongoing 
Time-slot curation, adaptive quizzes, weekly reviews 
V1 
Maintenance 
Dec 2025 
Basic content delivery, legacy quiz format 
Legacy 
Deprecated 
Jun 2025 
Original endpoint structure, minimal features 
Base URLs
Production: <https://api.taphealth.com/dtx/v{version}/education/>
Staging: <https://staging-api.taphealth.com/dtx/v{version}/education/>
Core Data Models
EducationPlanEntry
Purpose: Represents a single learning unit within the user's personalized education journey
interface EducationPlanEntry {
  // Identifiers
  id: string;                    // MongoDB ObjectId
  userId: string;                // User identifier
  contentId: number;             // Reference to master content library
  
  // Scheduling & Organization - CRITICAL PRD REQUIREMENT
  date: string;                  // YYYY-MM-DD - when this content is scheduled
  timeSlot: TimeSlot;           // REQUIRED: morning | afternoon | evening | bedtime
  
  // Content Data
  title: string;                 // Human-readable lesson title
  description: string;           // Brief lesson summary (2-3 sentences)
  script?: string;              // Video transcript for accessibility
  
  // Media Assets
  video: {
    url: string;                 // HLS streaming URL (CDN-optimized)
    thumbnail: string;           // Optimized preview image (WebP format)
    fullTime: string;           // Total duration in MM:SS format
    playbackTime: string;       // Current user progress in MM:SS format
  };
  
  // Assessment Data - ENHANCED FOR PRD
  quiz: QuizQuestion[];          // Array of 3 quiz questions with explanations
  
  // Progress Tracking - CRITICAL PRD REQUIREMENT
  completionStatus: boolean;     // true if quiz passed (3/3) and video watched
  progress: {
    watchPercentage: number;     // 0-100, calculated from playbackTime/fullTime
    quizAttempts: number;       // Total quiz attempts for this lesson
    lastQuizScore: number;      // Most recent quiz score (0-3)
    needsReview: boolean;       // true if quiz failed, requires remediation
    lastAccessed: string;       // ISO timestamp of last interaction
    streakContribution: boolean; // true if this lesson counts toward daily streak
  };
  
  // Metadata for Personalization - CRITICAL PRD REQUIREMENT
  metadata: {
    collection: string;          // "Nutrition" | "Basics" | "Lifestyle" | "Advanced"
    difficulty: DifficultyLevel; // easy | moderate | advanced
    videoType: VideoType;       // basics | lifestyle-tip | deep-dive | case-study
    estimatedWatchTime: number; // Minutes to complete lesson
    tags: string[];             // ["diabetes-basics", "meal-planning", etc.]
    priority: number;           // 1-10 priority for daily plan generation
    prerequisiteLessons?: string[]; // Required completed lessons
  };
  
  // Analytics & Insights - PRD REQUIREMENT
  analytics: {
    viewCount: number;          // Total times accessed
    averageWatchTime: number;   // Average completion percentage
    skipToQuizRate: number;     // % who skip video for quiz
    passRate: number;           // % who pass quiz on first attempt
  };
  
  // Audit Trail
  createdAt: string;            // ISO timestamp
  updatedAt: string;            // ISO timestamp
}
QuizQuestion
Purpose: Individual assessment question with answer validation and feedback
interface QuizQuestion {
  _id: string;                  // Question identifier
  question: string;             // Question text
  options: string[];            // Array of 3-4 multiple choice options
  correctOption: string;        // Exact text match of correct answer
  explanation?: string;         // REQUIRED: Educational feedback for incorrect answers
  difficulty: DifficultyLevel;  // Question complexity level
  topic: string;               // Subject area (e.g., "glucose-monitoring")
  timeSpent?: number;          // Seconds spent answering (tracked during submission)
  userAnswer?: string;         // User's selected answer (populated after submission)
  isCorrect?: boolean;         // Whether user answered correctly (populated after submission)
}
TimeSlot Definitions
enum TimeSlot {
  MORNING = "morning",     // 12:30 AM - 12:00 PM ("Morning Game Plan")
  AFTERNOON = "afternoon", // 12:00 PM - 4:00 PM ("Afternoon Lift") 
  EVENING = "evening",     // 4:00 PM - 8:00 PM ("Evening Essentials")
  BEDTIME = "bedtime"      // 8:00 PM - 12:30 AM ("Bedtime Prep")
}

enum DifficultyLevel {
  EASY = "easy",           // Foundational concepts
  MODERATE = "moderate",   // Intermediate application
  ADVANCED = "advanced"    // Complex scenarios and problem-solving
}

enum VideoType {
  BASICS = "basics",               // Core diabetes education
  LIFESTYLE_TIP = "lifestyle-tip", // Practical daily advice
  DEEP_DIVE = "deep-dive",        // Comprehensive topic exploration
  CASE_STUDY = "case-study"       // Real-world scenario analysis
}
WeeklyReview Data Model
Purpose: Aggregated learning assessment for knowledge retention
interface WeeklyReview {
  weekPeriod: {
    startDate: string;          // Monday of the review week (YYYY-MM-DD)
    endDate: string;            // Sunday of the review week (YYYY-MM-DD)
    availableFrom: string;      // When review becomes accessible (ISO timestamp)
  };
  
  summary: {
    lessonsCompleted: number;   // Total lessons finished this week
    topicsLearned: string[];    // Unique topics covered
    averageQuizScore: number;   // Mean score across all quizzes (0-3)
    streakDays: number;         // Consecutive days with learning activity
  };
  
  topicSummaries: TopicSummary[]; // Key learnings by subject area
  
  reviewQuiz: {
    totalQuestions: number;     // Adaptive based on week's content
    questions: WeeklyQuizQuestion[]; // Mix of topics covered
    timeLimit?: number;         // Optional time constraint (minutes)
  };
  
  rewards: {
    completionBadge?: string;   // Achievement identifier
    experiencePoints: number;  // Gamification points earned
    unlockableContent?: string[]; // Premium content unlocked
  };
  
  status: "pending" | "in_progress" | "completed" | "expired";
}

interface TopicSummary {
  topic: string;              // Subject area name
  keyLearnings: string[];     // 2-3 bullet points of main concepts
  masteryLevel: number;       // 0-100 calculated from quiz performance
  recommendedNext: string[];  // Suggested follow-up topics
}
Daily Learning APIs
1. Get Daily Education Plan
Endpoint: GET /api/dtx/v2/education
Purpose: Retrieves the user's personalized daily learning plan with time-slot organization. This is the primary entry point for the daily education experience (PRD Step 1).
Who Uses It: Mobile apps, web dashboard, coach portalWhen to Use: App launch, Learn tab navigation, periodic refreshWhat to Expect: Time-organized content list with current availability status
Request Parameters
GET /api/dtx/v2/education?currentDate=2025-07-03&timeSlot=morning&includeCompleted=false
Parameter
Type
Required
Description
Default



currentDate 
string 
Yes 
Date in YYYY-MM-DD format 




timeSlot 
string 
No 
Filter by specific slot: morning\
afternoon\
evening\
bedtime 
All slots 
includeCompleted 
boolean 
No 
Include already completed lessons 
true 



refreshCache 
boolean 
No 
Force regeneration of cached plan 
false 



Response Format
{
  "code": 200,
  "status": "success",
  "message": "Daily plan loaded successfully",
  "data": {
    "planDate": "2025-07-03",
    "currentTimeSlot": "morning",
    "totalLessons": 4,
    "completedToday": 1,
    "isBufferPeriod": false,
    
    "timeSlots": {
      "morning": {
        "label": "Morning Game Plan",
        "activeWindow": "12:30 AM - 12:00 PM",
        "isCurrentSlot": true,
        "isAvailable": true,
        "lessons": [
          {
            "id": "67aa587a3e05ebd502122187",
            "title": "Understanding A1C Levels",
            "description": "Learn what A1C means and how it tracks your diabetes management over time.",
            "estimatedTime": 3,
            "difficulty": "easy",
            "collection": "Basics",
            "thumbnail": "<https://cdn.taphealth.com/education/thumbnails/a1c-basics.webp>",
            "status": "not_started",
            "timeSlot": "morning",
            "video": {
              "duration": "02:45",
              "playbackTime": "00:00"
            },
            "quiz": {
              "totalQuestions": 3,
              "attempts": 0
            },
            "metadata": {
              "collection": "Basics",
              "difficulty": "easy",
              "videoType": "basics",
              "tags": ["diabetes-basics", "a1c", "glucose-monitoring"],
              "priority": 8
            },
            "progress": {
              "watchPercentage": 0,
              "quizAttempts": 0,
              "needsReview": false,
              "streakContribution": false
            }
          }
        ]
      },
      "afternoon": {
        "label": "Afternoon Lift", 
        "activeWindow": "12:00 PM - 4:00 PM",
        "isCurrentSlot": false,
        "isUpcoming": true,
        "isAvailable": false,
        "lessons": [
          {
            "id": "67aa587a3e05ebd502122188",
            "title": "Healthy Meal Planning",
            "description": "Learn to plan diabetes-friendly meals that fit your lifestyle.",
            "estimatedTime": 4,
            "difficulty": "moderate",
            "collection": "Nutrition",
            "timeSlot": "afternoon",
            "status": "locked",
            "metadata": {
              "collection": "Nutrition",
              "difficulty": "moderate",
              "videoType": "lifestyle-tip",
              "tags": ["nutrition", "meal-planning", "lifestyle"]
            }
          }
        ]
      },
      "evening": {
        "label": "Evening Essentials",
        "activeWindow": "4:00 PM - 8:00 PM", 
        "isCurrentSlot": false,
        "isUpcoming": true,
        "isAvailable": false,
        "lessons": []
      },
      "bedtime": {
        "label": "Bedtime Prep",
        "activeWindow": "8:00 PM - 12:30 AM",
        "isCurrentSlot": false,
        "isUpcoming": true, 
        "isAvailable": false,
        "lessons": []
      }
    },
    
    "summary": {
      "streakDays": 4,
      "completionRate": 0.75,
      "needsReview": ["67aa587a3e05ebd502122185"],
      "dailyGoalProgress": 0.25,
      "nextMilestone": {
        "type": "weekly_completion",
        "progress": 6,
        "target": 10
      }
    },
    
    "personalization": {
      "reasonForCuration": "Based on your recent quiz performance and learning goals",
      "adaptedFor": ["morning_learner", "nutrition_focused"],
      "carryForwardCount": 1
    }
  },
  "meta": {
    "requestId": "req_8f7e6d5c4b3a",
    "responseTime": 245,
    "cacheHit": true,
    "nextRefresh": "2025-07-04T00:30:00Z",
    "planGeneratedAt": "2025-07-03T00:30:00Z"
  }
}
Buffer Period Response (12:00-12:30 AM)
During the daily plan generation window, a special response is returned:
{
  "code": 200,
  "status": "success", 
  "message": "Building today's personalized plan",
  "data": {
    "bufferPeriod": true,
    "estimatedReady": "2025-07-04T00:30:00Z",
    "fallbackContent": {
      "yesterdayAvailable": true,
      "exploreRecommended": ["nutrition-basics", "glucose-monitoring"]
    }
  }
}
Error Scenarios
Error Code
Scenario
Response
Client Action
404 
No plan exists for date 
{"code": 404, "message": "No education plan found for this date"} 
Show empty state, suggest Explore 
429 
Rate limit exceeded 
{"code": 429, "retryAfter": 60} 
Implement exponential backoff 
503 
Plan generation in progress 
{"code": 503, "message": "Plan being generated, try again in 30s"} 
Retry with delay, show loading state 
2. Get Video Summary
Endpoint: GET /api/dtx/v2/education/{lessonId}/summary
Purpose: Provides lesson preview information before video playback (PRD Step 2). Enables users to make informed decisions about watching vs. skipping to quiz.
Who Uses It: Mobile apps when user taps on lesson card  When to Use: Before video playback, when user needs lesson context  What to Expect: Detailed lesson metadata with action options
Request Parameters
GET /api/dtx/v2/education/67aa587a3e05ebd502122187/summary
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Video summary retrieved successfully",
  "data": {
    "id": "67aa587a3e05ebd502122187",
    "title": "Understanding A1C Levels",
    "description": "Learn what A1C means for your diabetes management and how to interpret your test results.",
    "collection": "Basics",
    "difficulty": "easy",
    "estimatedTime": 3,
    
    "learningObjectives": [
      "Understand what A1C measures",
      "Know target A1C ranges for diabetes",
      "Learn how A1C relates to daily glucose readings"
    ],
    
    "video": {
      "duration": "02:45",
      "thumbnail": "<https://cdn.taphealth.com/education/thumbnails/a1c-basics.webp>",
      "hasTranscript": true
    },
    
    "quiz": {
      "totalQuestions": 3,
      "allowSkipToQuiz": true,
      "averageTime": "1 minute"
    },
    
    "status": {
      "current": "not_started",
      "progress": {
        "watchPercentage": 0,
        "quizAttempts": 0,
        "lastAccessed": null
      }
    },
    
    "actions": {
      "primary": {
        "type": "start_video",
        "label": "Start Learning",
        "enabled": true
      },
      "secondary": {
        "type": "skip_to_quiz", 
        "label": "Skip to Quiz",
        "enabled": true,
        "disclaimer": "Test your existing knowledge"
      }
    }
  }
}
Resume Video Response
For lessons with existing progress:
{
  "code": 200,
  "status": "success",
  "message": "Video summary retrieved successfully",
  "data": {
    "id": "67aa587a3e05ebd502122187",
    "title": "Understanding A1C Levels",
    "status": {
      "current": "in_progress",
      "progress": {
        "watchPercentage": 65,
        "lastPosition": "01:47",
        "lastAccessed": "2025-07-03T14:22:00Z"
      }
    },
    "actions": {
      "primary": {
        "type": "resume_video",
        "label": "Resume from 1:47",
        "enabled": true
      },
      "secondary": {
        "type": "start_over",
        "label": "Start Over",
        "enabled": true
      }
    }
  }
}
Assessment & Progress APIs
3. Submit Quiz Answers
Endpoint: POST /api/dtx/v2/education/quiz/submit
Purpose: Handles quiz submission and determines lesson completion status (PRD Steps 3 & 4). Implements the 3/3 pass requirement and intelligent remediation paths.
Who Uses It: Mobile apps, web interfaceWhen to Use: After video completion or skip-to-quiz selectionWhat to Expect: Immediate scoring with next-action guidance
Request Format
{
  "educationPlanId": "67aa587a3e05ebd502122187",
  "sessionId": "sess_8f7e6d5c4b3a",
  "attemptNumber": 1,
  "answers": [
    {
      "questionId": "67aa587a3e05ebd50212214e",
      "selectedOption": "Average blood sugar over 3 months",
      "timeSpent": 15
    },
    {
      "questionId": "67aa587a3e05ebd50212214f", 
      "selectedOption": "Pancreas",
      "timeSpent": 8
    },
    {
      "questionId": "67aa587a3e05ebd502122150",
      "selectedOption": "7% or lower",
      "timeSpent": 12
    }
  ],
  "deviceInfo": {
    "platform": "ios",
    "version": "2.1.0",
    "deviceId": "device_xyz123"
  },
  "source": "after_video",
  "startTime": "2025-07-03T15:30:00Z",
  "endTime": "2025-07-03T15:31:15Z"
}
Successful Response (3/3 Correct)
{
  "code": 200,
  "status": "success",
  "message": "Excellent work! Lesson completed successfully",
  "data": {
    "score": 3,
    "totalQuestions": 3,
    "passed": true,
    "completionTime": 75,
    
    "results": [
      {
        "questionId": "67aa587a3e05ebd50212214e",
        "correct": true,
        "explanation": "A1C measures average blood glucose over 2-3 months"
      },
      {
        "questionId": "67aa587a3e05ebd50212214f",
        "correct": true,
        "explanation": "Insulin is produced by beta cells in the pancreas"
      },
      {
        "questionId": "67aa587a3e05ebd502122150",
        "correct": true,
        "explanation": "For most adults with diabetes, A1C target is below 7%"
      }
    ],
    
    "lessonStatus": {
      "current": "completed",
      "updated": "2025-07-03T15:31:15Z",
      "addedToProgress": true
    },
    
    "achievements": {
      "streakUpdated": {
        "current": 5,
        "milestone": "5-day learning streak!"
      },
      "badgeEarned": null,
      "pointsAwarded": 15
    },
    
    "motivationalPrompts": [
      {
        "type": "streak_celebration",
        "message": "Amazing! 5 days of consistent learning! 🔥",
        "action": "continue_streak",
        "rewardPreview": "Keep going for bigger rewards!"
      }
    ],
    
    "nextActions": {
      "primary": {
        "type": "next_lesson",
        "lessonId": "67aa587a3e05ebd502122188",
        "title": "Reading Your Glucose Meter",
        "available": true
      },
      "secondary": {
        "type": "view_progress",
        "label": "See Your Progress",
        "enabled": true
      }
    },
    
    "dailySummary": {
      "completedToday": 3,
      "remainingToday": 1,
      "dailyGoalProgress": 0.75
    }
  }
}
Failed Response (Score < 3/3)
{
  "code": 200,
  "status": "success",
  "message": "Almost there! Let's review this topic together",
  "data": {
    "score": 2,
    "totalQuestions": 3, 
    "passed": false,
    "completionTime": 85,
    
    "results": [
      {
        "questionId": "67aa587a3e05ebd50212214e",
        "correct": true,
        "explanation": "Correct! A1C measures average blood glucose over 2-3 months"
      },
      {
        "questionId": "67aa587a3e05ebd50212214f",
        "correct": false,
        "selectedAnswer": "Liver", 
        "correctAnswer": "Pancreas",
        "explanation": "Insulin is actually produced by beta cells in the pancreas, not the liver",
        "conceptArea": "anatomy-basics"
      },
      {
        "questionId": "67aa587a3e05ebd502122150",
        "correct": true,
        "explanation": "Excellent! The target A1C for most adults is below 7%"
      }
    ],
    
    "lessonStatus": {
      "current": "needs_review",
      "updated": "2025-07-03T15:31:15Z",
      "addedToReviewQueue": true
    },
    
    "remediation": {
      "recommendedAction": "rewatch_video",
      "focusAreas": ["anatomy-basics", "insulin-function"],
      "estimatedReviewTime": 2,
      "additionalResources": [
        {
          "type": "related_video",
          "title": "How Your Body Produces Insulin",
          "id": "67aa587a3e05ebd502122155"
        }
      ]
    },
    
    "nextActions": {
      "primary": {
        "type": "rewatch_video",
        "label": "Review the Video",
        "enabled": true,
        "note": "Focus on how insulin is produced"
      },
      "secondary": {
        "type": "try_again_later",
        "label": "Try Again Later", 
        "enabled": true,
        "note": "This will appear in your weekly review"
      }
    },
    
    "retryPolicy": {
      "canRetry": true,
      "unlimited": true,
      "cooldownPeriod": 0
    }
  }
}
4. Update Video Playback Progress
Endpoint: PATCH /api/dtx/v2/education/video/playback
Purpose: Tracks video viewing progress for analytics and resume functionality. Critical for completion validation and engagement metrics.
Who Uses It: Video player componentsWhen to Use: Every 10 seconds during video playback, on pause/play/seekWhat to Expect: Lightweight acknowledgment with updated progress
Request Format
{
  "lessonId": "67aa587a3e05ebd502122187",
  "playbackTime": "01:23",
  "totalTime": "02:45",
  "watchPercentage": 50.3,
  "sessionId": "sess_8f7e6d5c4b3a",
  "timestamp": "2025-07-03T15:28:33Z",
  "eventType": "progress_update"
}
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Progress updated",
  "data": {
    "lessonId": "67aa587a3e05ebd502122187",
    "currentProgress": {
      "playbackTime": "01:23",
      "watchPercentage": 50.3,
      "lastUpdated": "2025-07-03T15:28:33Z"
    },
    "milestones": {
      "halfway": true,
      "almostComplete": false
    },
    "autoSaveEnabled": true
  }
}
5. Get Learning Progress Analytics
Endpoint: GET /api/dtx/v2/education/progress
Purpose: Comprehensive learning analytics dashboard data. Powers progress tracking, streak visualization, and performance insights.
Who Uses It: Mobile progress screens, web dashboard, coach portalWhen to Use: Progress tab access, weekly summaries, coach reviewsWhat to Expect: Detailed analytics with actionable insights
Request Parameters
GET /api/dtx/v2/education/progress?period=week&includeDetails=true
Parameter
Type
Required
Description
Options
period 
string 
No 
Analytics timeframe 
day, week, month, all 
includeDetails 
boolean 
No 
Include lesson-level breakdown 
Default: false 
metric 
string 
No 
Focus on specific metric 
completion, quiz, engagement 
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Learning progress retrieved successfully",
  "data": {
    "overview": {
      "totalLessonsCompleted": 47,
      "currentStreak": 8,
      "longestStreak": 12,
      "averageQuizScore": 2.7,
      "totalWatchTime": 142,
      "completionRate": 0.85
    },
    
    "streakData": {
      "current": 8,
      "longest": 12,
      "dailyActivity": [
        { "date": "2025-06-27", "lessonsCompleted": 2, "active": true },
        { "date": "2025-06-28", "lessonsCompleted": 3, "active": true },
        { "date": "2025-06-29", "lessonsCompleted": 1, "active": true }
        // ... last 30 days
      ]
    },
    
    "weeklyProgress": {
      "currentWeek": {
        "startDate": "2025-06-30",
        "endDate": "2025-07-06", 
        "lessonsCompleted": 14,
        "goal": 15,
        "progressPercent": 93
      },
      "topicsLearned": ["nutrition", "glucose-monitoring", "medication-management"],
      "averageSessionTime": 8.5,
      "quizPerformance": {
        "averageScore": 2.8,
        "improvementRate": 0.15,
        "difficultAreas": ["carb-counting", "insulin-timing"]
      }
    },
    
    "achievements": {
      "recentBadges": [
        {
          "id": "nutrition_master", 
          "name": "Nutrition Master",
          "earnedDate": "2025-07-02",
          "description": "Completed all basic nutrition lessons"
        }
      ],
      "nextMilestone": {
        "type": "streak_milestone",
        "target": 10,
        "current": 8,
        "daysRemaining": 2
      }
    },
    
    "needsAttention": {
      "reviewQueue": [
        {
          "lessonId": "67aa587a3e05ebd502122185",
          "title": "Carb Counting Basics",
          "failedDate": "2025-07-01",
          "attempts": 2,
          "lastScore": 1
        }
      ],
      "recommendations": [
        {
          "type": "review_topic",
          "title": "Review Carbohydrate Counting",
          "reason": "Multiple quiz failures",
          "priority": "high"
        }
      ]
    }
  }
}
Content Discovery APIs
6. Explore Education Library
Endpoint: GET /api/dtx/v2/education/explore
Purpose: Browse the complete education library with filtering and search capabilities (PRD Step 5). Enables user-driven content discovery beyond daily plans.
Who Uses It: Mobile explore tab, web library, search functionalityWhen to Use: User wants to browse beyond daily plan, search for specific topicsWhat to Expect: Organized content library with smart filtering
Request Parameters
GET /api/dtx/v2/education/explore?collection=nutrition&difficulty=easy&status=not_started&search=carb
Parameter
Type
Required
Description
Options
collection 
string 
No 
Filter by content category 
nutrition, basics, lifestyle, advanced 
difficulty 
string 
No 
Filter by complexity level 
easy, moderate, advanced 
status 
string 
No 
Filter by completion status 
not_started, in_progress, completed, needs_review 
search 
string 
No 
Text search in titles/descriptions 
Any string 
limit 
number 
No 
Results per page 
Default: 20, Max: 100 
offset 
number 
No 
Pagination offset 
Default: 0 
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Library content retrieved successfully",
  "data": {
    "totalResults": 127,
    "filters": {
      "applied": {
        "collection": "nutrition",
        "difficulty": "easy"
      },
      "available": {
        "collections": [
          { "name": "nutrition", "count": 34, "label": "Nutrition & Diet" },
          { "name": "basics", "count": 28, "label": "Diabetes Basics" },
          { "name": "lifestyle", "count": 41, "label": "Lifestyle Management" },
          { "name": "advanced", "count": 24, "label": "Advanced Topics" }
        ],
        "difficulties": [
          { "level": "easy", "count": 67 },
          { "level": "moderate", "count": 43 },
          { "level": "advanced", "count": 17 }
        ]
      }
    },
    
    "collections": [
      {
        "name": "nutrition",
        "displayName": "Nutrition & Diet",
        "description": "Learn about food choices, meal planning, and carbohydrate counting",
        "totalLessons": 34,
        "completedLessons": 12,
        "estimatedTime": 95,
        "difficulty": "easy",
        "thumbnail": "<https://cdn.taphealth.com/collections/nutrition.webp>",
        "featured": true,
        
        "lessons": [
          {
            "id": "67aa587a3e05ebd502122190",
            "title": "Carb Counting Made Simple",
            "description": "Master the basics of counting carbohydrates in your meals",
            "duration": "03:15",
            "difficulty": "easy",
            "status": "not_started",
            "thumbnail": "<https://cdn.taphealth.com/education/thumbnails/carb-counting.webp>",
            "tags": ["carbohydrates", "meal-planning", "basics"],
            "estimatedTime": 5,
            "quiz": {
              "totalQuestions": 3,
              "averageScore": 2.4,
              "passRate": 0.78
            }
          }
        ]
      }
    ],
    
    "recommendations": {
      "personalized": [
        {
          "lessonId": "67aa587a3e05ebd502122195",
          "reason": "Based on your recent quiz performance",
          "confidence": 0.87
        }
      ],
      "trending": [
        {
          "lessonId": "67aa587a3e05ebd502122198",
          "reason": "Most watched this week",
          "viewCount": 1247
        }
      ]
    },
    
    "pagination": {
      "current": 1,
      "total": 7,
      "hasNext": true,
      "hasPrevious": false,
      "nextOffset": 20
    }
  }
}
7. Weekly Review Management
Endpoint: GET /api/dtx/v2/education/weekly-review
Purpose: Generate personalized weekly learning review and assessment. Reinforces knowledge retention and identifies learning gaps.
Who Uses It: Mobile apps for weekly summaries, coach portal for progress monitoringWhen to Use: Sunday evening/Monday morning, triggered notificationsWhat to Expect: Comprehensive review with adaptive quiz
Request Parameters
GET /api/dtx/v2/education/weekly-review?week=2025-W27&includeQuiz=true
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Weekly review generated successfully",
  "data": {
    "reviewPeriod": {
      "week": "2025-W27",
      "startDate": "2025-06-30",
      "endDate": "2025-07-06",
      "availableUntil": "2025-07-13T23:59:59Z"
    },
    
    "summary": {
      "lessonsCompleted": 14,
      "activeDays": 6,
      "totalWatchTime": 38,
      "averageQuizScore": 2.6,
      "topicsLearned": ["nutrition", "glucose-monitoring", "medication-management"],
      "streak": {
        "maintained": true,
        "currentLength": 8
      }
    },
    
    "topicSummaries": [
      {
        "topic": "Nutrition & Meal Planning",
        "lessonsCompleted": 6,
        "keyLearnings": [
          "Carbohydrate counting affects blood glucose levels",
          "Portion control helps manage post-meal spikes",
          "Fiber slows glucose absorption"
        ],
        "masteryLevel": 85,
        "recommendedNext": ["advanced-carb-counting", "restaurant-eating"]
      }
    ],
    
    "reviewQuiz": {
      "totalQuestions": 8,
      "estimatedTime": 4, // minutes
      "adaptiveQuestions": true,
      "questions": [
        {
          "_id": "review_q1_2025w27",
          "question": "Based on this week's lessons, what's the main benefit of counting carbohydrates?",
          "options": [
            "Weight loss",
            "Better blood glucose control", 
            "Increased energy",
            "Improved sleep"
          ],
          "topic": "nutrition",
          "difficulty": "moderate",
          "sourceLesson": "67aa587a3e05ebd502122190"
        }
      ]
    },
    
    "rewards": {
      "available": {
        "completionBadge": "weekly_learner_july",
        "experiencePoints": 50,
        "unlockableContent": ["advanced_nutrition_tips"]
      },
      "requirements": {
        "quizPassScore": 6, // out of 8
        "timeLimit": null
      }
    },
    
    "status": "pending"
  }
}
Submit Weekly Review
POST /api/dtx/v2/education/weekly-review/submit
Request Format:
{
  "reviewId": "review_2025w27_67aa587a",
  "answers": [
    {
      "questionId": "review_q1_2025w27",
      "selectedOption": "Better blood glucose control",
      "timeSpent": 12
    }
  ],
  "startTime": "2025-07-07T19:30:00Z",
  "endTime": "2025-07-07T19:34:15Z"
}
Response Format:
{
  "code": 200,
  "status": "success",
  "message": "Weekly review submitted successfully",
  "data": {
    "score": 7,
    "totalQuestions": 8,
    "passed": true,
    "rewards": {
      "badgeEarned": "weekly_learner_july",
      "experiencePoints": 50
    },
    "nextWeekPreview": {
      "availableDate": "2025-07-14",
      "estimatedLessons": 12
    }
  }
}
14. Get Weekly Review (Cron-Generated)
Note: Weekly reviews are automatically generated by background cron jobs after user onboarding and updated daily. No manual generation endpoint is exposed per architectural decision.
Endpoint: GET /api/dtx/v2/education/weekly-review
Purpose: Retrieves pre-generated weekly review quiz and summary. Critical PRD requirement for knowledge retention.
Who Uses It: Mobile apps for weekly summaries, coach portal for progress monitoringWhen to Use: Sunday evening/Monday morning, triggered notificationsWhat to Expect: Pre-generated comprehensive review with adaptive quiz
Request Parameters
GET /api/dtx/v2/education/weekly-review?week=2025-W27&includeQuiz=true
Response Format (Pre-Generated Content)
{
  "code": 200,
  "status": "success",
  "message": "Weekly review retrieved successfully",
  "data": {
    "reviewId": "review_8f7e6d5c4b3a",
    "generatedBy": "cron_job",
    "generatedAt": "2025-07-06T00:30:00Z",
    "weekPeriod": {
      "startDate": "2025-06-30",
      "endDate": "2025-07-06",
      "availableUntil": "2025-07-13T23:59:59Z"
    },
    
    "summary": {
      "lessonsCompleted": 14,
      "activeDays": 6,
      "totalWatchTime": 38,
      "averageQuizScore": 2.6,
      "topicsLearned": ["nutrition", "glucose-monitoring", "medication-management"],
      "streakDays": 6
    },
    
    "reviewQuiz": {
      "totalQuestions": 10,
      "timeLimit": 15,
      "autoGenerated": true,
      "questions": [
        {
          "_id": "review_q1",
          "question": "What is the recommended A1C target for most adults with diabetes?",
          "options": ["Below 6%", "Below 7%", "Below 8%", "Below 9%"],
          "correctOption": "Below 7%",
          "explanation": "For most adults with diabetes, the A1C target is below 7%",
          "difficulty": "moderate",
          "topic": "glucose-monitoring",
          "originalLessonId": "67aa587a3e05ebd502122187"
        }
      ]
    },
    
    "topicSummaries": [
      {
        "topic": "nutrition",
        "keyLearnings": [
          "Carbohydrates have the biggest impact on blood sugar",
          "Portion control is crucial for diabetes management"
        ],
        "masteryLevel": 85,
        "recommendedNext": ["advanced-carb-counting", "meal-timing"]
      }
    ],
    
    "achievements": {
      "weeklyCompletionBadge": "Learning Champion",
      "experiencePoints": 150,
      "streakBonus": 25
    }
  }
}
15. Submit Weekly Review Quiz
Endpoint: POST /api/dtx/v2/education/weekly-review/submit
Purpose: Handles weekly review quiz submission and generates insights. PRD requirement for long-term retention tracking.
Request Format
{
  "reviewId": "review_8f7e6d5c4b3a",
  "answers": [
    {
      "questionId": "review_q1",
      "selectedOption": "Below 7%",
      "timeSpent": 8
    }
  ],
  "totalTimeSpent": 420,
  "startTime": "2025-07-07T19:00:00Z",
  "endTime": "2025-07-07T19:07:00Z"
}
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Weekly review completed successfully!",
  "data": {
       "score": 8,
    "totalQuestions": 10,
    "percentage": 80,
    "passed": true,
    "improvements": [
      {
        "topic": "medication-management",
        "scoreDelta": "+15%",
        "note": "Great improvement from last week!"
      }
    ],
    "recommendations": [
      {
        "type": "review_topic",
        "topic": "insulin-timing",
        "reason": "Score below 70% on related questions"
      }
    ],
    "nextWeekPreview": {
      "suggestedTopics": ["advanced-nutrition", "exercise-diabetes"],
      "focusAreas": ["insulin-timing", "meal-planning"]
    }
  }
}
16. Get Learning Streaks & Achievements
Endpoint: GET /api/dtx/v2/education/streaks
Purpose: Retrieves user streak data and achievements. Critical PRD requirement for gamification and habit formation.
Response Format
{
  "code": 200,
  "status": "success",
  "data": {
    "currentStreak": {
      "days": 8,
      "startDate": "2025-06-28",
      "type": "daily_completion",
      "milestone": "1 week streak!"
    },
    
    "streakHistory": {
      "longestStreak": 23,
      "totalStreaks": 12,
      "averageStreakLength": 6.4,
      "streakBreakReasons": ["weekend", "travel", "illness"]
    },
    
    "achievements": [
      {
        "id": "first_week_complete",
        "name": "Week Warrior",
        "description": "Completed learning for 7 consecutive days",
        "earnedDate": "2025-07-01",
        "badge": "<https://cdn.taphealth.com/badges/week-warrior.png>"
      }
    ],
    
    "milestones": {
      "next": {
        "type": "two_week_streak",
        "target": 14,
        "current": 8,
        "daysRemaining": 6,
        "reward": "Advanced Content Unlock"
      },
      "available": [
        { "name": "Perfect Week", "requirement": "7 consecutive days" },
        { "name": "Quiz Master", "requirement": "Pass 20 quizzes in a row" }
      ]
    },
    
    "weeklyGoals": {
      "current": {
        "target": 15,
        "completed": 12,
        "percentage": 80,
        "daysLeft": 1
      },
      "history": [
        { "week": "2025-W26", "target": 15, "completed": 18, "achieved": true }
      ]
    }
  }
}
17. Coach Integration Endpoints
Endpoint: GET /api/dtx/v2/education/coach/insights
Purpose: Provides coach-specific insights for patient education progress. PRD requirement for coach portal integration.
Response Format
{
  "code": 200,
  "status": "success",
  "data": {
    "patientSummary": {
      "userId": "user_12345",
      "engagementLevel": "high",
      "riskLevel": "low",
      "lastActivity": "2025-07-06T14:30:00Z"
    },
    
    "learningProgress": {
      "totalLessonsCompleted": 47,
      "weeklyAverage": 12.3,
      "strugglingTopics": ["insulin-timing", "carb-counting"],
      "masteredTopics": ["glucose-basics", "medication-basics"]
    },
    
    "behaviorInsights": {
      "preferredLearningTimes": ["morning", "evening"],
      "skipToQuizRate": 0.23,
      "averageSessionLength": 8.5,
      "retentionConcerns": [
        {
          "topic": "medication-management",
          "concern": "Multiple quiz failures",
          "suggested_action": "Schedule review session"
        }
      ]
    },
    
    "recommendations": [
      {
        "type": "intervention_needed",
        "priority": "medium",
        "message": "Patient struggling with carb counting - consider 1:1 session",
        "data": {
          "topic": "carb-counting",
          "failureRate": 0.7,
          "lastAttempt": "2025-07-05"
        }
      }
    ]
  }
}
18. Learning Path Recommendations
Endpoint: GET /api/dtx/v2/education/recommendations
Purpose: AI-powered learning path recommendations based on user progress and needs. PRD requirement for personalization.
Request Parameters
GET /api/dtx/v2/education/recommendations?userId=12345&context=daily_plan&limit=5
Response Format
{
  "code": 200,
  "status": "success",
  "data": {
    "personalizedRecommendations": [
      {
        "lessonId": "67aa587a3e05ebd502122195",
        "title": "Advanced Carb Counting",
        "reason": "Based on quiz performance in nutrition basics",
        "confidence": 0.87,
        "priority": "high",
        "estimatedBenefit": "Will improve meal planning accuracy by 40%"
      }
    ],
    
    "trendingContent": [
      {
        "lessonId": "67aa587a3e05ebd502122198",
        "title": "Summer Diabetes Management",
        "reason": "Popular this week",
        "viewCount": 1247
      }
    ],
    
    "remediationSuggestions": [
      {
        "lessonId": "67aa587a3e05ebd502122185",
        "title": "Insulin Timing Basics",
        "reason": "Failed quiz 3 times - needs review",
        "urgency": "high",
        "lastAttempt": "2025-07-03"
      }
    ],
    
    "learningPaths": [
      {
        "pathId": "nutrition_mastery",
        "name": "Nutrition Mastery Path",
        "description": "Complete guide to diabetes nutrition",
        "estimatedDuration": "3 weeks",
        "lessons": [
          "nutrition-basics",
          "carb-counting",
          "meal-planning",
          "advanced-nutrition"
        ],
        "currentProgress": 0.5
      }
    ]
  }
}
Simple Error:
{
  "statusCode": 400,
  "status": "error",
  "message": "No education plan found for this date",
  "error": {
    "message": "No education plan found for this date"
  }
}
Authentication Error:
{
  "statusCode": 401,
  "status": "error",
  "message": "Authorization error",
  "error": {
    "message": "Authorization error"
  }
}
Error Handling & Resilience
Standard Error Response Format
All errors follow a consistent structure for reliable client-side handling:
Validation Error:
{
  "statusCode": 400,
  "status": "error", 
  "message": "Validation failed",
  "error": {
    "message": "Validation failed",
    "details": [
      {
        "field": "currentDate",
        "message": "date cannot be empty"
      }
    ]
  }
}
Rate Limit Error:
{
  "statusCode": 429,
  "status": "error",
  "message": "Rate limit exceeded",
  "error": {
    "message": "Rate limit exceeded",
    "retryAfter": 60
  }
}
Server Error:
{
  "statusCode": 500,
  "status": "error",
  "message": "Internal server error",
  "error": {
    "message": "Internal server error"
  }
}
HTTP Status Code Guidelines
Code
Usage
Retry Strategy
Client Action
200 
Success 
N/A 
Process response data 
400 
Invalid request data 
No retry 
Fix request parameters 
401 
Authentication failure 
No retry 
Redirect to login 
403 
Insufficient permissions 
No retry 
Request access upgrade 
404 
Resource not found 
No retry 
Show not found state 
429 
Rate limit exceeded 
Exponential backoff 
Wait and retry 
500 
Internal server error 
Linear backoff 
Show error state, retry 
503 
Service unavailable 
Exponential backoff 
Show maintenance mode 
Resilience Patterns
Circuit Breaker Implementation
Threshold: 5 failures in 60 seconds
Recovery: Attempt every 30 seconds
Fallback: Cached data or graceful degradation
Retry Policy
interface RetryConfig {
  maxAttempts: 3;
  baseDelay: 1000; // ms
  maxDelay: 30000; // ms
  backoffMultiplier: 2;
  retryableErrors: [429, 500, 502, 503, 504];
}
Graceful Degradation
Video playback: Fall back to audio-only or transcript
Quiz submission: Cache locally, sync when available
Progress tracking: Optimistic updates with eventual consistency
Error Scenarios & Handling
Network Connectivity Issues
{
  "code": 0,
  "status": "network_error",
  "message": "Unable to connect to education service",
  "error": {
    "type": "connectivity_error",
    "offline": true,
    "cachedDataAvailable": true,
    "retryable": true
  }
}
Client Strategy: Show cached content, queue updates for sync
Rate Limiting Response
{
  "code": 429,
  "status": "error",
  "message": "Too many requests. Please try again later.",
  "error": {
    "type": "rate_limit_exceeded",
    "retryAfter": 60,
    "dailyQuotaRemaining": 850,
    "retryable": true
  }
}
Client Strategy: Implement exponential backoff, show rate limit UI
Content Generation Failure
{
  "code": 503,
  "status": "error",
  "message": "Education plan is being generated. Please try again shortly.",
  "error": {
    "type": "generation_in_progress",
    "estimatedCompletionTime": "2025-07-04T00:30:00Z",
    "fallbackAvailable": true,
    "retryable": true
  }
}
Client Strategy: Show generation progress, offer yesterday's content
Performance & Scaling
Performance Targets
Metric
Target
Monitoring
API Response Time 
P95 < 300ms 
CloudWatch, DataDog 
Video Load Time 
< 2 seconds 
CDN metrics 
Quiz Submission 
< 100ms 
Database query time 
Cache Hit Rate 
85% 
Redis metrics 
Availability 
99.9% 
Uptime monitoring 
Caching Strategy
Redis Cache Layers
interface CacheConfig {
  dailyPlan: {
    ttl: 86400; // 24 hours
    key: "education:plan:{userId}:{date}";
    warmupTime: "00:30"; // Pre-generate at 12:30 AM
  };
  
  videoMetadata: {
    ttl: 604800; // 7 days
    key: "education:video:{lessonId}";
    invalidateOn: ["content_update"];
  };
  
  userProgress: {
    ttl: 3600; // 1 hour
    key: "education:progress:{userId}";
    writeThrough: true;
  };
}
CDN Configuration
Video Assets: CloudFront with global edge locations
Static Images: WebP format with lazy loading
API Responses: Edge caching for non-personalized data
Database Optimization
MongoDB Indexing Strategy
// Education Plan indexes
db.educationPlans.createIndex({ userId: 1, date: 1 });
db.educationPlans.createIndex({ userId: 1, completionStatus: 1 });
db.educationPlans.createIndex({ date: 1, "metadata.timeSlot": 1 });

// Quiz Performance indexes  
db.quizResults.createIndex({ userId: 1, createdAt: -1 });
db.quizResults.createIndex({ lessonId: 1, passed: 1 });
Read Replica Strategy
Read Operations: Route to nearest replica
Write Operations: Primary cluster only
Analytics Queries: Dedicated analytics replica
Horizontal Scaling
Load Balancing
Algorithm: Least connections with health checks
Auto-scaling: Based on CPU (70%) and memory (80%) thresholds
Geographic: Route to nearest data center
Service Dependencies
graph TD
    A[API Gateway] --> B[Education Service]
    B --> C[Content Service]
    B --> D[Progress Service]
    B --> E[Analytics Service]
    C --> F[MongoDB Primary]
    D --> F
    D --> G[Redis Cluster]
    E --> H[ClickHouse Analytics DB]
Legacy Compatibility
Migration Strategy
V1 to V2 Transition
Dual Operation: Both versions run in parallel
Feature Parity: V1 endpoints maintained until deprecation
Data Compatibility: Shared database with schema versioning
Client Migration: Gradual rollout with feature flags
Deprecated Endpoints (V1)
Generate Education Plan (Deprecated)
POST /api/dtx/education/generate
Status: Removed as of V2.0.0Migration Path: Use cron-generated daily plans via GET /api/dtx/v2/educationFinal Support: June 30, 2025
Legacy Progress Update
PATCH /api/dtx/education/video/status?id={lessonId}
Status: Deprecated, use V2 playback endpointMigration Path: PATCH /api/dtx/v2/education/video/playbackSupport Until: December 31, 2025
Backward Compatibility Matrix
Feature
V1 Support
V2 Enhancement
Migration Required
Basic video retrieval 
✅ Full 
Enhanced metadata 
Optional 
Quiz submission 
✅ Full 
Detailed feedback 
Recommended 
Progress tracking 
⚠️ Limited 
Real-time analytics 
Required 
Time-slot curation 
❌ None 
Core feature 
Required 
Weekly reviews 
❌ None 
New feature 
N/A 
Data Schema Evolution
V1 Schema Support
// Legacy EducationPlan structure (maintained)
interface LegacyEducationPlan {
  userId: string;
  date: string;
  title: string;
  description: string;
  video: {
    url: string;
    thumbnail: string;
    fullTime: string;
    playbackTime: string;
  };
  quiz: LegacyQuizQuestion[];
  completionStatus: boolean;
}
V2 Schema Extensions
// Enhanced structure with backward compatibility
interface EducationPlanV2 extends LegacyEducationPlan {
  metadata: TimeSlotMetadata;
  progress: DetailedProgress;
  analytics: EngagementMetrics;
}
Conclusion
This API contract represents a production-ready foundation for TapHealth's Education Module, designed to serve millions of users while maintaining the flexibility to evolve with changing healthcare education needs. The architecture emphasizes reliability, scalability, and developer experience, ensuring both current functionality and future extensibility.
Key Implementation Priorities
Reliability First: Circuit breakers, retries, and graceful degradation
Performance Optimization: Intelligent caching and CDN utilization  
User Experience: Consistent response formats and clear error handling
Analytics Integration: Comprehensive tracking for continuous improvement
Compliance: HIPAA-ready data handling and audit capabilities
Next Steps
Phase 1: Core daily plan and quiz APIs (V2.0) - Target: Q3 2025
Phase 2: Weekly review and advanced analytics (V2.1) - Target: Q4 2025
Phase 3: AI-powered personalization and adaptive difficulty (V2.2) - Target: Q1 2026
Implementation Readiness Checklist
[ ] Backend API endpoints implemented
[ ] Database schema migration scripts ready
[ ] Authentication & authorization integration
[ ] Rate limiting and caching configured
[ ] Error monitoring and alerting setup
[ ] Mobile/web client integration testing
[ ] Performance benchmarking completed
[ ] Security audit passed
[ ] Documentation and deployment guides finalized
Technical Dependencies
Database: MongoDB 6.0+ with proper indexing
Cache: Redis Cluster 7.0+ for session management
CDN: CloudFront for video delivery
Analytics: ClickHouse for learning analytics
Monitoring: DataDog/CloudWatch for performance tracking
For implementation questions or clarifications, contact the Platform Engineering team or refer to the detailed technical specifications in the engineering documentation.
User Insights and Feedback APIs
10. Get User Engagement Insights
Endpoint: GET /api/dtx/v2/education/analytics/user-insights
Purpose: Provides personalized user engagement analysis aligned with PRD user goals. Powers coach recommendations and adaptive learning.
Who Uses It: Coach portal, personalization engine, mobile insights tabWhen to Use: Coach review sessions, app insights display, algorithm trainingWhat to Expect: User-specific behavioral patterns and recommendations
Request Parameters
GET /api/dtx/v2/education/analytics/user-insights?userId=12345&period=month&includeRecommendations=true
Response Format
{
  "code": 200,
  "status": "success",
  "message": "User engagement insights retrieved successfully",
  "data": {
    "userId": "user_12345",
    "period": {
      "type": "month",
      "startDate": "2025-06-01",
      "endDate": "2025-06-30"
    },
    
    "learningProfile": {
      "preferredTimeSlots": [
        { "slot": "morning", "engagement": 0.78 },
        { "slot": "evening", "engagement": 0.65 },
        { "slot": "afternoon", "engagement": 0.42 },
        { "slot": "bedtime", "engagement": 0.31 }
      ],
      "topicMastery": [
        { "topic": "nutrition", "masteryLevel": 0.85, "confidence": "high" },
        { "topic": "glucose-monitoring", "masteryLevel": 0.72, "confidence": "medium" },
        { "topic": "medication", "masteryLevel": 0.45, "confidence": "low" }
      ],
      "learningPace": {
        "averageWatchSpeed": 1.1,
        "typicalSessionLength": 8.5,
        "preferredDifficulty": "moderate",
        "skipToQuizRate": 0.23
      }
    },
    
    "progressMetrics": {
      "streakAnalysis": {
        "currentStreak": 8,
        "longestStreak": 15,
        "streakBreakPatterns": ["weekends", "travel"]
      },
      "completionPatterns": {
        "dailyGoalAchievement": 0.73,
        "weeklyConsistency": 0.68,
        "timeToComplete": 6.2
      },
      "quizPerformance": {
        "averageScore": 2.7,
        "improvementRate": 0.15,
        "strugglingTopics": ["carb-counting", "insulin-timing"],
        "masteredTopics": ["basic-anatomy", "glucose-basics"]
      }
    },
    
    "behavioralInsights": {
      "engagementTriggers": [
        "coach_message",
        "streak_milestone",
        "weekly_review"
      ],
      "dropoffRisks": [
        {
          "factor": "quiz_failures",
          "severity": "medium",
          "recommendation": "offer_easier_content"
        }
      ],
      "motivationFactors": {
        "gamification": 0.67,
        "progress_tracking": 0.84,
        "social_validation": 0.31
      }
    },
    
    "recommendations": {
      "contentSuggestions": [
        {
          "lessonId": "67aa587a3e05ebd502122200",
          "reason": "Addresses struggled topic: carb-counting",
          "priority": "high",
          "estimatedImpact": 0.78
        }
      ],
      "behavioralNudges": [
        {
          "type": "time_reminder",
          "message": "Your best learning time is 8 AM - ready for today's lesson?",
          "timing": "optimal_slot"
        }
      ],
      "coachingActions": [
        {
          "action": "review_insulin_timing",
          "context": "User struggling with this topic for 2 weeks",
          "urgency": "medium"
        }
      ]
    },
    
    "crossModuleImpact": {
      "glucoseTracking": {
        "improvement": 0.18,
        "correlation": "strong",
        "note": "Better compliance after diabetes basics lessons"
      },
      "foodLogging": {
        "improvement": 0.15,
        "correlation": "moderate",
        "note": "More accurate logs after nutrition education"
      }
    }
  }
}
11. Submit Learning Feedback
Endpoint: POST /api/dtx/v2/education/feedback
Purpose: Captures user feedback on content quality and learning experience. Critical for continuous improvement.
Who Uses It: Mobile apps, web interfaceWhen to Use: After lesson completion, periodic surveys, content ratingWhat to Expect: Feedback acknowledgment with impact tracking
Request Format
{
  "lessonId": "67aa587a3e05ebd502122187",
  "feedbackType": "content_rating",
  "rating": 4,
  "feedback": "Great explanation of A1C, but could use more real-world examples",
  "categories": ["content_quality", "practical_examples"],
  "userId": "user_12345",
  "timestamp": "2025-07-06T10:30:00Z"
}
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Thank you for your feedback!",
  "data": {
    "feedbackId": "fb_8f7e6d5c4b3a",
    "acknowledged": true,
    "impact": {
      "contentTeamNotified": true,
      "improvementQueued": true,
      "estimatedUpdate": "2025-07-20"
    }
  }
}
12. Plan Generation Health Check
Endpoint: GET /api/dtx/v2/education/plan/status
Purpose: Monitors daily plan generation status during buffer periods. Critical for system reliability during peak generation times.
Who Uses It: Mobile apps, monitoring systems, support toolsWhen to Use: During buffer period (12:00-12:30 AM), system health checksWhat to Expect: Real-time generation status with estimated completion
Request Parameters
GET /api/dtx/v2/education/plan/status?date=2025-07-04&userId=12345
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Plan generation status retrieved",
  "data": {
    "planDate": "2025-07-04",
    "generationStatus": "in_progress",
    "progress": {
      "percentage": 75,
      "currentStage": "content_curation",
      "estimatedCompletion": "2025-07-04T00:28:00Z"
    },
    "systemHealth": {
      "contentService": "healthy",
      "personalizationEngine": "healthy",
      "cacheService": "healthy"
    },
    "fallbackOptions": {
      "previousDay": true,
      "exploreContent": true,
      "defaultPlan": false
    }
  }
}
Buffer Period States
Status
Description
Client Action
pending 
Generation not started 
Show buffer message 
in_progress 
Active generation 
Show progress with ETA 
completed 
Plan ready 
Redirect to main endpoint 
failed 
Generation error 
Show fallback options 
13. Batch Progress Update
Endpoint: POST /api/dtx/v2/education/progress/batch
Purpose: Handles bulk progress updates for offline usage scenarios. Ensures data consistency when users learn offline.
Who Uses It: Mobile apps with offline capabilitiesWhen to Use: After reconnection, bulk sync operationsWhat to Expect: Batch processing with conflict resolution
Request Format
{
  "updates": [
    {
      "lessonId": "67aa587a3e05ebd502122187",
      "action": "video_progress",
      "data": {
        "playbackTime": "02:15",
        "watchPercentage": 81.8,
        "timestamp": "2025-07-03T15:25:00Z"
      }
    },
    {
      "lessonId": "67aa587a3e05ebd502122188",
      "action": "quiz_submission",
      "data": {
        "answers": [...],
        "score": 3,
        "timestamp": "2025-07-03T15:30:00Z"
      }
    }
  ],
  "deviceId": "device_xyz123",
  "syncTimestamp": "2025-07-03T15:35:00Z"
}
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Batch updates processed successfully",
  "data": {
    "processed": 2,
    "successful": 2,
    "failed": 0,
    "conflicts": [],
    "updates": [
      {
        "lessonId": "67aa587a3e05ebd502122187",
        "status": "updated",
        "conflicts": null
      },
      {
        "lessonId": "67aa587a3e05ebd502122188",
        "status": "updated",
        "newCompletionStatus": true
      }
    ]
  }
}
15. Submit Weekly Review Quiz
Endpoint: POST /api/dtx/v2/education/weekly-review/submit
Purpose: Handles weekly review quiz submission and generates insights. PRD requirement for long-term retention tracking.
Request Format
{
  "reviewId": "review_8f7e6d5c4b3a",
  "answers": [
    {
      "questionId": "review_q1",
      "selectedOption": "Below 7%",
      "timeSpent": 8
    }
  ],
  "totalTimeSpent": 420,
  "startTime": "2025-07-07T19:00:00Z",
  "endTime": "2025-07-07T19:07:00Z"
}
Response Format
{
  "code": 200,
  "status": "success",
  "message": "Weekly review completed successfully!",
  "data": {
       "score": 8,
    "totalQuestions": 10,
    "percentage": 80,
    "passed": true,
    "improvements": [
     
      {
        "topic": "medication-management",
        "scoreDelta": "+15%",
        "note": "Great improvement from last week!"
      }
    ],
    "recommendations": [
      {
        "type": "review_topic",
        "topic": "insulin-timing",
        "reason": "Score below 70% on related questions"
      }
    ],
    "nextWeekPreview": {
      "suggestedTopics": ["advanced-nutrition", "exercise-diabetes"],
      "focusAreas": ["insulin-timing", "meal-planning"]
    }
  }
}
16. Get Learning Streaks & Achievements
Endpoint: GET /api/dtx/v2/education/streaks
Purpose: Retrieves user streak data and achievements. Critical PRD requirement for gamification and habit formation.
Response Format
{
  "code": 200,
  "status": "success",
  "data": {
    "currentStreak": {
      "days": 8,
      "startDate": "2025-06-28",
      "type": "daily_completion",
      "milestone": "1 week streak!"
    },
    
    "streakHistory": {
      "longestStreak": 23,
      "totalStreaks": 12,
      "averageStreakLength": 6.4,
      "streakBreakReasons": ["weekend", "travel", "illness"]
    },
    
    "achievements": [
      {
        "id": "first_week_complete",
        "name": "Week Warrior",
        "description": "Completed learning for 7 consecutive days",
        "earnedDate": "2025-07-01",
        "badge": "<https://cdn.taphealth.com/badges/week-warrior.png>"
      }
    ],
    
    "milestones": {
      "next": {
        "type": "two_week_streak",
        "target": 14,
        "current": 8,
        "daysRemaining": 6,
        "reward": "Advanced Content Unlock"
      },
      "available": [
        { "name": "Perfect Week", "requirement": "7 consecutive days" },
        { "name": "Quiz Master", "requirement": "Pass 20 quizzes in a row" }
      ]
    },
    
    "weeklyGoals": {
      "current": {
        "target": 15,
        "completed": 12,
        "percentage": 80,
        "daysLeft": 1
      },
      "history": [
        { "week": "2025-W26", "target": 15, "completed": 18, "achieved": true }
      ]
    }
  }
}
17. Coach Integration Endpoints
Endpoint: GET /api/dtx/v2/education/coach/insights
Purpose: Provides coach-specific insights for patient education progress. PRD requirement for coach portal integration.
Response Format
{
  "code": 200,
  "status": "success",
  "data": {
    "patientSummary": {
      "userId": "user_12345",
      "engagementLevel": "high",
      "riskLevel": "low",
      "lastActivity": "2025-07-06T14:30:00Z"
    },
    
    "learningProgress": {
      "totalLessonsCompleted": 47,
      "weeklyAverage": 12.3,
      "strugglingTopics": ["insulin-timing", "carb-counting"],
      "masteredTopics": ["glucose-basics", "medication-basics"]
    },
    
    "behaviorInsights": {
      "preferredLearningTimes": ["morning", "evening"],
      "skipToQuizRate": 0.23,
      "averageSessionLength": 8.5,
      "retentionConcerns": [
        {
          "topic": "medication-management",
          "concern": "Multiple quiz failures",
          "suggested_action": "Schedule review session"
        }
      ]
    },
    
    "recommendations": [
      {
        "type": "intervention_needed",
        "priority": "medium",
        "message": "Patient struggling with carb counting - consider 1:1 session",
        "data": {
          "topic": "carb-counting",
          "failureRate": 0.7,
          "lastAttempt": "2025-07-05"
        }
      }
    ]
  }
}
18. Learning Path Recommendations
Endpoint: GET /api/dtx/v2/education/recommendations
Purpose: AI-powered learning path recommendations based on user progress and needs. PRD requirement for personalization.
Request Parameters
GET /api/dtx/v2/education/recommendations?userId=12345&context=daily_plan&limit=5
Response Format
{
  "code": 200,
  "status": "success",
  "data": {
    "personalizedRecommendations": [
      {
        "lessonId": "67aa587a3e05ebd502122195",
        "title": "Advanced Carb Counting",
        "reason": "Based on quiz performance in nutrition basics",
        "confidence": 0.87,
        "priority": "high",
        "estimatedBenefit": "Will improve meal planning accuracy by 40%"
      }
    ],
    
    "trendingContent": [
      {
        "lessonId": "67aa587a3e05ebd502122198",
        "title": "Summer Diabetes Management",
        "reason": "Popular this week",
        "viewCount": 1247
      }
    ],
    
    "remediationSuggestions": [
      {
        "lessonId": "67aa587a3e05ebd502122185",
        "title": "Insulin Timing Basics",
        "reason": "Failed quiz 3 times - needs review",
        "urgency": "high",
        "lastAttempt": "2025-07-03"
      }
    ],
    
    "learningPaths": [
      {
        "pathId": "nutrition_mastery",
        "name": "Nutrition Mastery Path",
        "description": "Complete guide to diabetes nutrition",
        "estimatedDuration": "3 weeks",
        "lessons": [
          "nutrition-basics",
          "carb-counting",
          "meal-planning",
          "advanced-nutrition"
        ],
        "currentProgress": 0.5
      }
    ]
  }
}
V2+ Enhancement APIs
PRD Optional Enhancements Implementation - Future roadmap:
Motivational Prompts & Messaging
Endpoint: GET /api/dtx/v2/education/prompts/motivational
Purpose: PRD requirement - "Great reward awaits", "1st week complete" motivational messaging
{
  "data": {
    "activePrompts": [
      {
        "id": "first_week_complete",
        "type": "milestone_celebration",
        "message": "🎉 1st week complete! Great reward awaits!",
        "trigger": "week_completion",
        "displayContext": "quiz_result_screen",
        "action": {
          "type": "view_reward",
          "label": "Claim Your Reward",
          "endpoint": "/api/dtx/v2/education/rewards/claim"
        },
        "priority": "high",
        "expiresAt": "2025-07-14T23:59:59Z"
      },
      {
        "id": "reward_preview",
        "type": "pre_quiz_motivation",
        "message": "Complete this quiz and a great reward awaits! 🏆",
        "trigger": "quiz_start",
        "displayContext": "quiz_intro",
        "action": {
          "type": "start_quiz",
          "label": "Start Quiz",
          "motivationalNote": "Your dedication is about to pay off!"
        },
        "priority": "medium"
      }
    ],
    "personalizedMessages": [
      {
        "message": "You're on fire! 🔥 Keep your 8-day streak alive!",
        "context": "daily_plan_header",
        "basedOn": "current_streak"
      }
    ]
  }
}
Endpoint: POST /api/dtx/v2/education/prompts/trigger
Purpose: Trigger specific motivational prompts based on user actions
{
  "promptType": "great_reward_awaits",
  "context": "weekly_review_available",
  "userState": {
    "currentStreak": 8,
    "weeklyProgress": 0.85,
    "rewardEligible": true
  },
  "personalizedElements": [
    "streak_milestone",
    "reward_preview",
    "achievement_ready"
  ]
}
Endpoint: GET /api/dtx/v2/education/rewards/preview
Purpose: Preview rewards to motivate quiz completion
{
  "data": {
    "upcomingRewards": [
      {
        "trigger": "weekly_review_completion",
        "reward": {
          "type": "content_unlock",
          "title": "Advanced Nutrition Masterclass",
          "description": "Unlock 5 premium lessons on advanced carb counting",
          "badge": "Nutrition Expert",
          "experiencePoints": 100
        },
        "requirements": {
          "weeklyQuizScore": "≥70%",
          "streakMaintained": true
        },
        "motivationalMessage": "Great reward awaits! Complete your weekly review to unlock exclusive content! 🌟"
      }
    ],
    "progressTowardsReward": {
      "currentScore": 6,
      "requiredScore": 7,
      "message": "Just 1 more correct answer for your reward!"
    }
  }
}
Streak & Gamification
Endpoint: GET /api/dtx/v2/education/streaks
Purpose: PRD gamification - "Streak logic for watching X lessons/day"
{
  "data": {
    "currentStreak": 8,
    "longestStreak": 15,
    "dailyGoal": 2,
    "streakMilestones": [
      { "days": 3, "badge": "Learning Starter", "earned": true },
      { "days": 7, "badge": "Week Warrior", "earned": true },
      { "days": 14, "badge": "Two Week Champion", "earned": false }
    ],
    "todayProgress": {
      "completed": 1,
      "remaining": 1,
      "canExtendStreak": true
    }
  }
}
Endpoint: POST /api/dtx/v2/education/streaks/milestone
Purpose: Streak milestone celebration
{
  "milestone": "7-day",
  "celebration": "confetti",
  "message": "Amazing! 7 days of consistent learning!",
  "rewards": {
    "badge": "Week Warrior",
    "points": 100,
    "unlocks": ["advanced_nutrition_series"]
  }
}
Weekly Progress Widget
Endpoint: GET /api/dtx/v2/education/weekly-summary
Purpose: PRD enhancement - "Your progress this week widget"
{
  "data": {
    "weekOf": "2025-07-07",
    "summary": {
      "lessonsCompleted": 12,
      "goalProgress": 0.8,
      "topTopics": ["nutrition", "glucose-monitoring"],
      "averageQuizScore": 2.7,
      "streakDays": 5
    },
    "dailyBreakdown": [
      { "date": "2025-07-07", "completed": 2, "timeSpent": 8 },
      { "date": "2025-07-08", "completed": 1, "timeSpent": 4 }
    ],
    "insights": [
      "You're strongest in nutrition topics",
      "Morning is your most active learning time",
      "Consider reviewing glucose monitoring concepts"
    ]
  }
}
Smart Nudges & Reminders
Endpoint: POST /api/dtx/v2/education/nudges/schedule
Purpose: PRD enhancement - "Smart nudges at 3PM: Still 2 videos left today"
{
  "nudgeType": "gentle_reminder",
  "scheduledFor": "15:00",
  "message": "Still 2 videos left today - keep your streak alive!",
  "personalizedReason": "based_on_learning_pattern",
  "actions": [
    { "type": "view_remaining", "label": "See Today's Plan" },
    { "type": "quick_lesson", "label": "Start 3-min Lesson" }
  ]
}
Auto-Play Preview
Endpoint: GET /api/dtx/v2/education/{lessonId}/preview
Purpose: PRD enhancement - "Auto-play preview (muted) on hover/tap"
{
  "data": {
    "previewUrl": "<https://cdn.taphealth.com/previews/a1c-basics-5sec.mp4>",
    "duration": 5,
    "startFrame": "00:00:15",
    "endFrame": "00:00:20",
    "muted": true,
    "autoplay": true,
    "fallbackThumbnail": "<https://cdn.taphealth.com/thumbnails/a1c-basics.webp>"
  }
}
Personalized Coach Messages
Endpoint: GET /api/dtx/v2/education/coach-messages
Purpose: PRD enhancement - "Personalized coach messages in each segment"
{
  "data": {
    "timeSlot": "morning",
    "message": {
      "text": "Good job yesterday, Barun! Ready for today's nutrition deep-dive?",
      "tone": "encouraging",
      "personalization": {
        "userName": "Barun",
        "basedOn": ["yesterday_completion", "nutrition_interest"],
        "context": "morning_greeting"
      }
    },
    "cta": {
      "primary": "Start Morning Plan",
      "secondary": "See Progress"
    }
  }
}
Weekly Review Quiz
Endpoint: GET /api/dtx/v2/education/weekly-review/quiz
Purpose: PRD enhancement - "Weekly review quiz auto-generated from failed lessons"
{
  "data": {
    "weekOf": "2025-07-07",
    "totalQuestions": 9,
    "basedOn": {
      "failedLessons": ["carb-counting", "insulin-timing"],
      "newConcepts": ["exercise-glucose"],
      "reinforcement": ["a1c-basics"]
    },
    "questions": [
      {
        "id": "weekly_q1",
        "question": "When is the best time to check blood sugar after exercise?",
        "options": ["Immediately", "15-30 minutes", "2 hours", "Next day"],
        "correctOption": "15-30 minutes",
        "explanation": "It's best to check blood sugar 15-30 minutes after exercise to see the immediate impact.",
        "difficulty": "moderate",
        "topic": "exercise-glucose",
        "originalLessonId": "67aa587a3e05ebd502122190"
      }
    ],
    "timeLimit": 15,
    "passingScore": 7
  }
}
Content Bookmarking
Endpoint: POST /api/dtx/v2/education/bookmarks
Purpose: PRD enhancement - "Bookmark videos to Learn Later"
{
  "lessonId": "67aa587a3e05ebd502122187",
  "bookmarkReason": "user_selected",
  "notes": "Want to review carb counting before grocery shopping",
  "scheduledFor": "2025-07-10",
  "priority": "high"
}
Endpoint: GET /api/dtx/v2/education/bookmarks
Purpose: Retrieve saved lessons
{
  "data": {
    "bookmarked": [
      {
        "lessonId": "67aa587a3e05ebd502122187",
        "title": "Carb Counting Made Simple",
        "bookmarkedAt": "2025-07-06T10:30:00Z",
        "notes": "Review before grocery shopping",
        "priority": "high",
        "scheduledFor": "2025-07-10"
      }
    ],
    "total": 3,
    "categories": {
      "nutrition": 2,
      "exercise": 1
    }
  }
}
Smart Filters
Endpoint: GET /api/dtx/v2/education/explore/filters
Purpose: PRD enhancement - "Smart filters (Only 2-min videos, Basics only)"
{
  "data": {
    "availableFilters": {
      "duration": [
        { "label": "Quick (1-2 min)", "value": "quick", "count": 23 },
        { "label": "Standard (3-5 min)", "value": "standard", "count": 45 },
        { "label": "Deep Dive (5+ min)", "value": "long", "count": 12 }
      ],
      "difficulty": [
        { "label": "Basics", "value": "easy", "count": 34 },
        { "label": "Intermediate", "value": "moderate", "count": 28 },
        { "label": "Advanced", "value": "advanced", "count": 15 }
      ],
      "completion": [
        { "label": "Not Started", "value": "not_started", "count": 41 },
        { "label": "In Progress", "value": "in_progress", "count": 8 },
        { "label": "Completed", "value": "completed", "count": 28 }
      ]
    }
  }
}
Trending Content
Endpoint: GET /api/dtx/v2/education/trending
Purpose: PRD enhancement - "Highlight trending topics or seasonal learning"
{
  "data": {
    "trending": [
      {
        "lessonId": "67aa587a3e05ebd502122200",
        "title": "Summer Hydration for Diabetics",
        "reason": "seasonal",
        "trendScore": 0.89,
        "viewsThisWeek": 1247,
        "tags": ["hydration", "summer", "lifestyle"]
      }
    ],
    "seasonal": {
      "theme": "summer_wellness",
      "lessons": ["hydration", "outdoor-exercise", "travel-tips"],
      "validUntil": "2025-09-21"
    }
  }
}